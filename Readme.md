# 情感分类

### 现在是3.19，先简单做做吧，把 NB、SVM、fasttext复现出来，找找参数。取一个最优结果

## 操作步骤：
* 1. 处理数据
* 2. 调包，选择一个效果比较好的分类器
* 3. 预测

## 详细介绍

### 处理数据

原始数据
carComment：github获取的汽车评论数据，包含［序号，标签，文本］三个字段
goodsComment：github获取的商品评论数据，包含［文本，标签］两个字段
bookCommentNeg: B站项目课程获取的书籍评论数据，为消极评论，包含［文本］一个字段
bookCommentPos: B站项目课程获取的书籍评论数据，为积极评论，包含［文本］一个字段
处理操作
把三个数据集拆成积极文本与消极文本。

### fasttext 分类器

遇到问题，目前不知因为什么原因。fasttext分类器在训练集与测试集 4:1的测试表现识别率有90%＋，但是在短文本评论表现并不好，出现偏向某一极的情况。初步猜测是数据差距很大。先把car book 数据集裁掉，看看啥情况。
减少数据集种类准确率提高不少，但是最后的预测部分还是出现两极分化。
群里有人解释：训练集、测试集  不均衡－－－－详见ai交流群。晚上看看
将预测文本经过分词等处理后效果好了一丢丢。先看下 朴素贝叶斯吧。

第二天又跑了一次， 45%－55%（neg－pos）

### Naive Bayes 分类器

朴素贝叶斯分类器测试结果是90%，最后的结果分布也还好，跟jiagu分类出得积极、消极情感比例类似 接近 50%－50%

### SVM 分类器

测试集 准确率90%， 预测预料结果分布：  17:3 （pos：neg）

## 结语

经过测验发现：不是数据越多越复杂越好。。也不是维度越多、迭代次数越多越好。然后就是大厂的东西还是值得信赖的。
再就是训练数据集还是得自己找机会抓，一定注意采样平衡，最好训练集与之后预测的数据是同一出处。
因为我这个要预测的数据集内容偏向抽象、幼稚化，跟训练集差别很大，加上预测集文本长度差异很大，导致效果不佳。都是泪。
* 教训
1. 训练集与预测样本，尽量相合
2. 预测样本也得按长文本，短文本，不同的类型来训练模型。
3. 预测样本进行，过滤［停用词、分词、长度］、或是不同参数调整［也不是说维度越多、迭代次数越多效果越好］后，预测样本也会得到提升。

下面用百度、jiagu进行正式的预测吧

************************************************************************************************************************************

# 预测

## 百度与jiagu的选择

分类器，最终选用的是百度开放平台，原因如下：
1. 分类效果抽样后非常不错
2. 有正负向情感得分

关于api调用问题
1. 次数限制，可以通过多申请token提速。（也可以考虑做爬虫，直接调用官网的测试接口，但不知反扒啥情况）
2. 本次调用文本没有做分词处理，当时想的百度给公众使用的，不需要考虑文本处理了。
3. 本次分类文本中，部分用户只填写emoji：⛽️等，单一个表情API无法判断，我的解决方法是尾部加句号。
4. 调取api过程中需要     response.keep_alive = False # 关闭多余连接

jiagu与百度开放平台相比，结果抽样也非常不错，但是没有情感得分。毕业设计嘛，挑做好的做。。



# 后续分析
前天跟导师交流，后续的分析：
必做项：情感倾向，异常检测
选作项：预测其它事件发酵

## 情感倾向
这个当时在［月小水长交流群］中有个研究－新冠疫情舆情管理的老哥，他这边给了一个很好的图示，我可以试着模仿
http://localhost:8890/view/Desktop/ym_workplac/ym_GraduationProject/img/%E6%83%85%E6%84%9F%E5%80%BE%E5%90%91%E6%A0%B7%E4%BE%8B.jpeg
在时间轴上体现出发言态度。
那么这个纵坐标如何确定就很值得考虑了。

目前我想到的：
1. 使用情感得分
x－时间， y－单位时间内，正向情感得分累加／正向情感总数、负向情感得分累加／负向情感总数
2. 不使用情感得分，知情感
x－时间， y－单位时间内，正向情感个数、负向情感个数

又跟这个老哥交流了下。他给出了两种思路。
1. 每日平均值变化
2. 统计每天的正向情感倾向占比。1日正向情感倾向占比30％， 2日情感倾向占比40%。。。。以此类推。详细见聊天记录。

这个评论吧，前几天数据量很大，所以比较均衡。后面人数少了，比率波动就比较大了。
统计结果波动很大，我决定加一个阈值控制下。

## 异常检测
这个异常检测有点问题，不知道是做内容异常（发言包含敏感内容）还是曲线异常（有一个时间点发言频次太多）


## 预测
我坚信，事件发言频次这个一定有规律可循，指数分布吗？






























